<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Time Zone Converter</title>
<style>
  :root{
    --bg:#f8fafc; --card:#fff; --border:#0f172a; --text:#0f172a; --muted:#64748b;
    --orange:#f97316; --blue:#2563eb; --ring:#bae6fd;
  }
  *{box-sizing:border-box} html,body{height:100%;margin:0}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Noto Sans;
       background:linear-gradient(#fff,var(--bg));color:var(--text)}
  .container{max-width:1200px;margin:40px auto;padding:28px;background:var(--card);
             border:6px solid var(--orange);border-radius:18px;box-shadow:0 8px 28px rgba(2,6,23,.08)}
  h1{margin:8px 0 18px;font-size:30px}

  .summary{border:3px solid var(--blue);border-radius:14px;padding:22px;
           display:grid;grid-template-columns:1.1fr 2fr;gap:18px;background:#fff}
  @media(max-width:980px){.summary{grid-template-columns:1fr}}
  .muted{color:var(--muted);font-size:15px;line-height:1.35}
  .big{font-size:32px;font-weight:800;margin:2px 0 10px}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
  @media(max-width:980px){.grid2{grid-template-columns:1fr}}
  .card{background:#fff;border:3px solid var(--border);border-radius:14px;padding:18px}
  /* Fixed row heights so time + slider rows are perfectly aligned */
  .card-grid{display:grid;grid-template-rows:auto 64px 56px 72px;gap:14px}

  .label{text-transform:uppercase;letter-spacing:.06em;color:#64748b;font-size:12px}
  .time-row{display:flex;align-items:center;gap:12px}
  .time{font-size:24px;font-weight:800;white-space:nowrap;margin-right:auto}
  .badge{font-size:12px;background:#f1f5f9;color:#334155;padding:2px 8px;border-radius:999px}

  .select,.input{border:2px solid var(--border);padding:12px 14px;border-radius:12px;background:#fff;width:100%;font-size:15px}
  .select{height:48px}

  /* sliders (track + ticks + thumb) */
  .range{
    -webkit-appearance:none;appearance:none;width:100%;height:10px;border-radius:8px;background:#e5e7eb;outline:none;position:relative;
    /* three ticks @ 25%, 50%, 75% */
    background-image:
      linear-gradient(#0f172a,#0f172a),
      linear-gradient(#0f172a,#0f172a),
      linear-gradient(#0f172a,#0f172a);
    background-size:2px 16px,2px 16px,2px 16px;
    background-repeat:no-repeat;
    background-position:calc(25% + 0px) 50%, 50% 50%, calc(75% - 0px) 50%;
  }
  .range::-webkit-slider-runnable-track{height:10px;border-radius:8px;background:transparent}
  .range::-webkit-slider-thumb{
    -webkit-appearance:none;appearance:none;width:22px;height:22px;border-radius:50%;
    background:#0b66ff;border:2px solid #fff;margin-top:-6px;box-shadow:0 0 0 1px rgba(0,0,0,.2)
  }
  .range::-moz-range-track{height:10px;border-radius:8px;background:transparent}
  .range::-moz-range-progress{height:10px;background:#0b66ff;border-radius:8px}
  .range::-moz-range-thumb{width:22px;height:22px;border-radius:50%;background:#0b66ff;border:2px solid #fff}

  .tick-wrap{padding-inline:14px} /* keep labels away from card borders */
  .ticks{display:flex;justify-content:space-between;font-size:12px;color:#64748b;margin-top:6px}
  .ticks span{width:0}
  .ticks span:first-child{transform:translateX(-1px)}
  .ticks span:nth-child(2){transform:translateX(0)}
  .ticks span:last-child{transform:translateX(1px)}

  /* Prospect combobox dropdown */
  .combo{position:relative}
  .dropdown{
    position:absolute;left:0;right:0;top:calc(100% + 6px);
    background:#fff;border:2px solid var(--border);border-radius:12px;
    max-height:300px;overflow:auto;box-shadow:0 14px 34px rgba(2,6,23,.12);
    z-index:50;display:none
  }
  .row{padding:10px 14px;cursor:pointer;font-size:15px}
  .row:hover,.row.active{background:#f8fafc}
  .hint{font-size:12px;color:#64748b;padding:6px 14px}
  .toggle{border:2px solid var(--border);background:#fff;border-radius:12px;padding:9px 14px;font-size:14px;cursor:pointer;font-weight:700}
  .toggle:disabled{opacity:.45;cursor:not-allowed}
  .toggle.active{background:#0ea5e9;border-color:#0ea5e9;color:#fff}
  .toggle:focus,.input:focus,.select:focus{outline:3px solid var(--ring)}

  .overlap{margin-top:14px;padding:10px 12px;border:2px dashed #cbd5e1;border-radius:10px;background:#fafcff}
  .ov-title{font-weight:700;margin-bottom:6px}
  .ov-row{font-size:14px;color:#0f172a;margin:2px 0}
</style>
</head>
<body>
  <div class="container">
    <h1>Time Zone Converter</h1>

    <div class="summary">
      <div>
        <div class="muted">Current difference</div>
        <div id="diff" class="big">—</div>
        <div class="muted">Drag either slider; the other mirrors exactly.</div>

        <div class="overlap">
          <div class="ov-title">Overlapping business hours (9–5 local)</div>
          <div id="overlap">Pick a prospect time zone to see overlaps.</div>
        </div>
      </div>

      <div class="grid2">
        <!-- PROSPECT (left) -->
        <div class="card">
          <div class="card-grid">
            <div class="label">Prospect’s Timezone</div>

            <div class="combo">
              <input id="pInput" class="input" placeholder="Type Country or City…" autocomplete="off" aria-label="Type to search country/city/time zone"/>
              <div id="pDrop" class="dropdown"></div>
            </div>

            <div class="time-row">
              <span id="pTime" class="time">--:--</span>
              <button id="milBtn" class="toggle" aria-pressed="false" disabled>Military time</button>
              <span id="badge" class="badge" style="display:none"></span>
            </div>

            <div class="tick-wrap">
              <input id="pRange" class="range" type="range" min="0" max="1439" step="15"/>
              <div class="ticks" id="pTicks"><span>–</span><span>–</span><span>–</span></div>
            </div>
          </div>
        </div>

        <!-- REP (right) -->
        <div class="card">
          <div class="card-grid">
            <div class="label">Rep’s Timezone</div>
            <select id="repSelect" class="select" aria-label="Select timezone">
              <option value="America/Los_Angeles">Pacific</option>
              <option value="America/Denver">Mountain</option>
              <option value="America/Chicago" selected>Central</option>
              <option value="America/New_York">Eastern</option>
            </select>

            <div class="time-row"><span id="repTime" class="time">--:--</span></div>

            <div class="tick-wrap">
              <input id="repRange" class="range" type="range" min="0" max="1439" step="15"/>
              <div class="ticks"><span>6 AM</span><span>12 PM</span><span>6 PM</span></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // ===== Helpers (DST-safe) =====
  const BASE = new Date();
  const pad = n => (n<10?'0':'')+n;
  const clamp = n => ((n%1440)+1440)%1440;

  function parts(d, tz){
    const f = new Intl.DateTimeFormat('en-US',{timeZone:tz,year:'numeric',month:'2-digit',day:'2-digit',
      hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false});
    const m = {}; f.formatToParts(d).forEach(p=>m[p.type]=p.value);
    return {year:+m.year,month:+m.month,day:+m.day,hour:+m.hour,minute:+m.minute,second:+m.second};
  }
  function offsetMin(tz,d){
    const p=parts(d,tz); const asUTC=Date.UTC(p.year,p.month-1,p.day,p.hour,p.minute,p.second);
    return (asUTC - d.getTime())/60000;
  }
  function localToUTC({year,month,day,hour,minute},tz){
    let guess = Date.UTC(year,month-1,day,hour,minute,0);
    let o = offsetMin(tz,new Date(guess));
    let utc = guess - o*60000;
    o = offsetMin(tz,new Date(utc));
    return new Date(Date.UTC(year,month-1,day,hour,minute,0) - o*60000);
  }
  function convert(mins, fromTz, toTz){
    const fp=parts(BASE,fromTz);
    const utc=localToUTC({year:fp.year,month:fp.month,day:fp.day,hour:Math.floor(mins/60),minute:mins%60},fromTz);
    const tp=parts(utc,toTz);
    const atFromMid=parts(localToUTC({year:fp.year,month:fp.month,day:fp.day,hour:0,minute:0},fromTz),toTz);
    const dayOff=Math.round((Date.UTC(tp.year,tp.month-1,tp.day)-Date.UTC(atFromMid.year,atFromMid.month-1,atFromMid.day))/(24*3600*1000));
    return {minutes:clamp(tp.hour*60+tp.minute), dayOff};
  }
  const fmt12 = m => { const h=Math.floor(m/60),mm=m%60,ap=h>=12?'PM':'AM',h12=((h+11)%12)+1; return h12+':'+pad(mm)+' '+ap; };
  const fmt24 = m => pad(Math.floor(m/60))+':'+pad(m%60);
  const labelTZ = tz => { const p=tz.split('/'); return p[0]+' — '+p.slice(1).join('/').replace(/_/g,' ')+' ('+tz+')'; };

  // ===== Data for search =====
  function allTZ(){
    try{ if (Intl.supportedValuesOf) return Intl.supportedValuesOf('timeZone'); }catch(e){}
    return ['Europe/London','Europe/Rome','Europe/Bucharest','America/New_York','America/Chicago','America/Denver','America/Los_Angeles'];
  }
  const ALL_TZ = allTZ();

  // Countries → primary zone (trimmed demo list; extend anytime)
  const COUNTRY_TZ = new Map([
    // Europe
    ['Romania','Europe/Bucharest'], ['Italy','Europe/Rome'], ['United Kingdom','Europe/London'],
    ['France','Europe/Paris'], ['Germany','Europe/Berlin'], ['Spain','Europe/Madrid'], ['Portugal','Europe/Lisbon'],
    ['Ireland','Europe/Dublin'], ['Poland','Europe/Warsaw'], ['Greece','Europe/Athens'],
    // Americas
    ['United States','America/New_York'], ['Canada','America/Toronto'], ['Mexico','America/Mexico_City'],
    // Asia/Oceania
    ['India','Asia/Kolkata'], ['China','Asia/Shanghai'], ['Japan','Asia/Tokyo'], ['Australia','Australia/Sydney']
  ]);

  const CITY_HINTS = new Map([
    ['london','Europe/London'], ['rome','Europe/Rome'], ['bucharest','Europe/Bucharest'], ['paris','Europe/Paris'],
    ['new york','America/New_York'], ['chicago','America/Chicago'], ['denver','America/Denver'], ['los angeles','America/Los_Angeles'],
    ['toronto','America/Toronto']
  ]);

  // Build options list: countries + zones + city aliases
  const SEARCH_ROWS = [];
  COUNTRY_TZ.forEach((tz,c)=>SEARCH_ROWS.push({label:`${c} — ${labelTZ(tz)}`, tz, key:c.toLowerCase()}));
  ALL_TZ.forEach(tz=>SEARCH_ROWS.push({label:labelTZ(tz), tz, key:tz.toLowerCase()}));
  CITY_HINTS.forEach((tz,city)=>SEARCH_ROWS.push({label:`${city[0].toUpperCase()+city.slice(1)} — ${labelTZ(tz)}`, tz, key:city}));

  // ===== Elements =====
  const repSelect = document.getElementById('repSelect');
  const repRange  = document.getElementById('repRange');
  const repTime   = document.getElementById('repTime');

  const pInput = document.getElementById('pInput');
  const pDrop  = document.getElementById('pDrop');
  const pTime  = document.getElementById('pTime');
  const pRange = document.getElementById('pRange');
  const milBtn = document.getElementById('milBtn');
  const badge  = document.getElementById('badge');
  const diffEl = document.getElementById('diff');
  const overlapEl = document.getElementById('overlap');

  // ===== State (start at 12:00 PM; sliders mirror both ways) =====
  let state = {
    repTz: repSelect.value,
    repMins: 720,              // start centered at 12 PM
    pTz: null,
    pMins: null,
    p24: false
  };

  const REP_TICKS = [360,720,1080]; // 6 AM, 12 PM, 6 PM
  function setPTicks(a){
    const el=document.getElementById('pTicks');
    el.children[0].textContent=a[0]; el.children[1].textContent=a[1]; el.children[2].textContent=a[2];
  }
  function updateProspectTickLabels(){
    if (!state.pTz){ setPTicks(['–','–','–']); return; }
    const labels = REP_TICKS.map(mins=>{
      const m = convert(mins, state.repTz, state.pTz).minutes;
      return state.p24 ? fmt24(m) : fmt12(m);
    });
    setPTicks(labels);
  }

  function render(){
    // time readouts
    repTime.textContent = fmt12(state.repMins);
    // mirror thumbs: both sliders show same position
    repRange.value = state.repMins;
    pRange.value   = state.repMins;

    const active = !!state.pTz;
    milBtn.disabled = !active;

    if (active){
      const conv = convert(state.repMins, state.repTz, state.pTz);
      state.pMins = conv.minutes;
      pTime.textContent = state.p24 ? fmt24(state.pMins) : fmt12(state.pMins);

      if (conv.dayOff !== 0){ badge.style.display='inline-block'; badge.textContent=(conv.dayOff>0?'+':'')+conv.dayOff+' day'; }
      else badge.style.display='none';

      let d = (state.pMins - state.repMins)/60; d = Math.round(d*100)/100; if (d>12) d-=24; if (d<-12) d+=24;
      diffEl.textContent = (d>0?'+':'') + d + ' hrs';

      updateProspectTickLabels();
      updateOverlap();
    } else {
      pTime.textContent = '--:--';
      badge.style.display='none';
      diffEl.textContent = '—';
      setPTicks(['–','–','–']);
      overlapEl.textContent = 'Pick a prospect time zone to see overlaps.';
    }
  }

  // ===== Prospect dropdown =====
  function rowsFor(q){
    const s=(q||'').trim().toLowerCase();
    if(!s) return [];
    return SEARCH_ROWS.filter(r => r.key.includes(s) || r.label.toLowerCase().includes(s)).slice(0,400);
  }
  function openDrop(q){
    const rows = rowsFor(q);
    if (!rows.length){ pDrop.innerHTML='<div class="hint">No matches. Try a country or city.</div>'; pDrop.style.display='block'; return; }
    pDrop.innerHTML = rows.map(r=>`<div class="row" data-tz="${r.tz}">${r.label}</div>`).join('');
    pDrop.style.display='block';
  }
  function closeDrop(){ pDrop.style.display='none'; }
  pInput.addEventListener('input', ()=>openDrop(pInput.value));
  pInput.addEventListener('focus', ()=>openDrop(pInput.value));
  pInput.addEventListener('keydown', e=>{
    if (e.key==='Enter'){
      const first = pDrop.querySelector('.row'); if(first){ first.click(); e.preventDefault(); }
    } else if (e.key==='Escape'){ closeDrop(); }
  });
  document.addEventListener('click', e=>{ if(!pDrop.contains(e.target) && e.target!==pInput) closeDrop(); });
  pDrop.addEventListener('click', e=>{
    const row=e.target.closest('.row'); if(!row) return;
    state.pTz = row.getAttribute('data-tz');
    pInput.value = row.textContent; closeDrop();
    render();
  });

  // ===== Events (mirror both ways) =====
  repSelect.addEventListener('change', e=>{ state.repTz = e.target.value; updateProspectTickLabels(); updateOverlap(); render(); });
  repRange .addEventListener('input', e=>{ state.repMins = +e.target.value; render(); });
  pRange   .addEventListener('input', e=>{ state.repMins = +e.target.value; render(); }); // dragging left OR right keeps them equal
  milBtn.addEventListener('click', ()=>{
    if(!state.pTz) return;
    state.p24 = !state.p24;
    milBtn.classList.toggle('active', state.p24);
    milBtn.setAttribute('aria-pressed', String(state.p24));
    updateProspectTickLabels(); updateOverlap(); render();
  });

  // ===== Overlapping business hours (9–5 local on both sides) =====
  const WORK_START = 9*60, WORK_END = 17*60; // minutes

  function inWindow(mins, start, end){ return mins>=start && mins<end; }

  // Return array of segments {repStart, repEnd, pStart, pEnd, pDayShiftStart, pDayShiftEnd}
  function computeOverlap(repTz, pTz){
    if (!pTz) return [];
    const segments = [];
    let cur = null;

    for (let m=0; m<1440; m+=15){ // sample every 15 minutes across Rep day
      const p = convert(m, repTz, pTz);
      const repOk = inWindow(m, WORK_START, WORK_END);
      const pOk   = inWindow(p.minutes, WORK_START, WORK_END);

      if (repOk && pOk){
        if (!cur){
          cur = {repStart:m, pStart:p.minutes, pDayShiftStart:p.dayOff};
        }
        cur.repEnd = m + 15; // end is exclusive
        cur.pEnd   = p.minutes;
        cur.pDayShiftEnd = p.dayOff;
      } else if (cur){
        segments.push(cur); cur=null;
      }
    }
    if (cur) segments.push(cur);
    return segments;
  }

  function formatRangeLabel(repStart, repEnd, pStart, pEnd, dsStart, dsEnd){
    const repLabel = fmt12(repStart) + '–' + fmt12(repEnd);
    const pLabel24 = fmt24(pStart) + '–' + fmt24(pEnd);
    const pLabel12 = fmt12(pStart) + '–' + fmt12(pEnd);
    const ds = (dsStart||dsEnd) ? ` ${dsStart!==0||dsEnd!==0 ? '('+(dsStart>0||dsEnd>0?'+':'')+'1 day)' : ''}` : '';
    return {
      l12: `Rep ${repLabel} ↔ Prospect ${pLabel12}${ds}`,
      l24: `Rep ${repLabel} ↔ Prospect ${pLabel24}${ds}`
    };
  }

  function updateOverlap(){
    if (!state.pTz){ overlapEl.textContent='Pick a prospect time zone to see overlaps.'; return; }
    const segs = computeOverlap(state.repTz, state.pTz);
    if (!segs.length){ overlapEl.textContent='No overlap between 9–5 windows today.'; return; }
    const lines = segs.map(s => formatRangeLabel(s.repStart,s.repEnd,s.pStart,s.pEnd,s.pDayShiftStart,s.pDayShiftEnd));
    overlapEl.innerHTML = lines.map(l => `<div class="ov-row">${state.p24 ? l.l24 : l.l12}</div>`).join('');
  }

  // ===== Init =====
  // Center both sliders at noon from the start
  repRange.value = 720; pRange.value = 720;
  render();
})();
</script>
</body>
</html>
